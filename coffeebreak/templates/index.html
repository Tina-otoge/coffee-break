<!doctype html>
{% set prefilled = prefilled or {} %}
{% macro input(elem) %}
	<p class="form-input" id="form-{{ elem.id }}">

		{% if elem.params.type == 'radio' %}
		<span class="label">
			{{ elem.label }}:{% if elem.params.description %}
				<span class="description">{{ elem.params.description|safe }}</span>
			{% endif %}
		</span>
		{% for option in elem.params.radio %}
			{% with id = elem.id + '-' + option %}
			<span class="form-radio">
				<input type="radio" id="{{ id }}" name="{{ elem.id }}" value="{{ option }}"
					{% if prefilled[elem.name] == option %}checked{% endif %}
				>
				<label for={{ id }}>{{ option }}</label>
			</span>
			{% endwith %}
		{% endfor %}
		<span class="form-radio-other">
		{% with id = elem.id + '-other' %}
		<input type="radio" id="{{ id }}" name="{{ elem.id }}" value="">
		<label for="{{ id }}">Other: </label>
		<input type="text" name="{{ elem.id }}-other">
		{% endwith %}
		</span>
		{% else %}

		<label for="{{ elem.id }}">
			{{ elem.label }}:{% if elem.params.description %}
				<span class="description">{{ elem.params.description|safe }}</span>
			{% endif %}
		</label>
		{% if elem.params.type == 'textarea' %}
		<textarea
		{% else %}
		<input
		{%- endif %}
			{%- for key, value in elem.params.items() if value and key != 'description' %}
			{{ key + '=' + value }}
			{%- endfor %}
			{%- if prefilled[elem.name] %}
			value="{{ prefilled[elem.name] }}"
			{%- endif %}
			id="{{ elem.id }}"
			name="{{ elem.id }}"
		>{% if elem.params.type == 'textarea' %}</textarea>
		{% endif %}

		{% endif %}

	</p>
{%- endmacro %}
<html>
	<head>
		<meta charset="utf-8">
		<script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
		<title>Coffee Break ☕ - Scorecard generator</title>
		<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
	</head>

	<body>
		<h1><a href="{{ url_for('index') }}">Coffee Break ☕</a> The scorecard generator</h1>
		<main>
			<p>
				Check pre-filled values for reference:
			</p>
			<p>
				<a href="{{ url_for('prefilled', name='iidx_result') }}">IIDX</a>
				<a href="{{ url_for('prefilled', name='sdvx_result') }}">SDVX</a>
				<a href="{{ url_for('prefilled', name='scoresaber') }}">Score Saber</a>
				<a href="{{ url_for('prefilled', name='osu') }}">osu!</a>
			</p>
			<p>
				Available endpoints:
			</p>
			<ul>
				<li><i class="code">/api/generate</i>: Returns the generated scorecard as a binary encoded image<br>
					Alternatively, <i class="code">/api/card.jpg</i> can be used.</li>
				<li><i class="code">/api/card.html</i>: Returns the generated image as an HTML page</li>
				<li><i class="code">/api/register</i>: Saves the scorecard request and returns a JSON object with its ID and URL</li>
			</ul>
			<p>
				All endpoints are reachable on GET and POST requests.
			</p>

			<form id="gene-form" action="{{ url_for('generate_image') }}">
				{% for elem in inputs %}
				{{ input(elem) }}
				{% endfor %}
				<p>
					<input type="submit" value="Generate">
				</p>
			</form>
		</main>
	</body>
	<script>
		twemoji.parse(document.body);
	</script>
</html>
